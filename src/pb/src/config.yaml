# Уровень 1: Главный узел навигации, в котором содержатся все подсистемы
# Глобальная настройка для всех узлов
pb_config:
  # Уровень 2: Общие настройки
  control_mode: 1       # Режим работы управления. Если 0 то по колесам одометрии, 1 управление по скомплеменированному с измерением main
  pillars:
    # Уровень 3: Параметры
    pillar_0_x: 4.0          # Координата X начала координат карты...
    pillar_0_y: 0.3          # Координата X начала координат карты...
    
    pillar_1_x: 0.0          # Координата X начала координат карты...
    pillar_1_y: 0.5          # Координата X начала координат карты...
    
    pillar_2_x: 0.5          # Координата X начала координат карты...
    pillar_2_y: 4.0          # Координата X начала координат карты...
    
    pillar_3_x: 5.0          # Координата X начала координат карты...
    pillar_3_y: 4.0          # Координата X начала координат карты...
    
  start_pose:
    x: 2.0          # Координата X 
    y: 2.0          # Координата Y 
    th: 0.0         # Угол куда смотрим

  lidar:
    bias: -1.44       # Смещение угла относительно направления движения основы в градусах!!!
  
  modul:
    mode: 5           # Номер алгоритма выполнения при запуске

  uzi_bias: 1.2       # Смещение Ультразвукового датчика
  laser_L_bias: 1.3       # Смещение левого лазерного датчика
  laser_R_bias: 1.4       # Смещение правого лазерного датчика

  laser:
    bias_0: 0.011   # Смещения лазеров.Установить в процессе калибровки
    bias_1: 0.022
    bias_2: 0.033
    bias_3: 0.044

# --- Все данные для ноды SCAN ---
  scan_node:
# =========================================================================
  # --- 1. ПАРАМЕТРЫ СБОРА И ФИЛЬТРАЦИИ СЫРЫХ СКАНОВ ---
  # =========================================================================
  
  # Накопление и медианная фильтрация
  scans_to_collect: 100                 # Количество сканов, используемое для медианной фильтрации.

  # Фильтрация по интенсивности (выполняется в scanCallback)
  intensity_min_threshold: 10.0         # Минимальная интенсивность для включения луча в накопление.

  # Угловой/Краевой фильтр (для удаления фантомов/хвостов в removeEdgeArtifacts)
  edge_angle_threshold: 5.0             # Порог угла в градусах. Угол (0-90) между лучом лидара и сегментом.
  
  # --- Дополнительные фильтры (если используется PCL/Point Cloud) ---
  min_range_filter: 0.2                 # Минимальная дальность (ближе - игнорируется).
  max_range_filter: 15.0                # Максимальная дальность (дальше - игнорируется).

  # Параметры Statistical Outlier Removal (SOR) или аналогичного фильтра:
  neighbor_radius_filter: 0.3           # Радиус поиска соседей для фильтрации.
  min_neighbors_filter: 3               # Мин. число соседей для сохранения точки.


  # =========================================================================
  # --- 2. ГЕОМЕТРИЯ СТОЛБОВ (Для финальной калибровки) ---
  # =========================================================================

  pillar_diametr: 0.315                 # Диаметр столба (315 мм)
  
  # Расстояния между поверхностями столбов:
  pillar_0_1: 10.500                 # Расстояние RB-RT (Правая сторона)
  pillar_0_2: 12.000                 # Расстояние RB-LT (Диагональ)
  pillar_0_3: 4.800                  # Расстояние RB-LB (Нижняя сторона)
  pillar_1_2: 5.500                  # Расстояние RT-LT (Верхняя сторона)
  pillar_1_3: 11.500                 # Расстояние RT-LB (Диагональ)
  pillar_2_3: 4.800                  # Расстояние LT-LB (Левая сторона)


  # =========================================================================
  # --- 3. ДЕТЕКТИРОВАНИЕ И СЛИЯНИЕ (Будущие этапы) ---
  # =========================================================================

  detection:
    # Параметры Детекторов (Этап 2)
    jump_dist_threshold: 0.5            # Порог разрыва для Метод 1 (0.5 м)
    
    # Параметры DBSCAN-кластеризации:
    cluster_dist_threshold: 0.05        # Порог расстояния (epsilon) для Евклидовой Кластеризации (5 см)
    # NOTE: min_points для DBSCAN обычно выставляется в коде или в отдельном параметре.

  fusion:
    # Параметры Взвешивания и Слияния (Этап 3)
    rmse_max_tolerance: 0.01          # Макс. RMSE для нормализации веса
    n_max_points_norm: 100           # Макс. число точек для нормализации веса W_N
    fusion_group_radius: 0.2          # Радиус для объединения кандидатов из разных методов

  weights:
    # Ручные Коэффициенты Доверия Методам (W_method)
    w_method_1_jump: 1.0            # Вес для Метод 1 (Разрыв)
    w_method_2_cluster: 0.9           # Вес для Метод 2 (Кластер)
    w_method_3_minima: 0.8           # Вес для Метод 3 (Минимум)





















  #   # Уровень 3: Параметры загрузки файла
  # file_settings:
  #   map_file_path: "/home/user/ros_ws/maps/building_A.yaml" # Полный путь к файлу карты...
  #   load_on_start: true                                     # Флаг: загружать ли карту при старте...

  # # Уровень 2: Настройки глобального планировщика (Global Planner)
  # global_planner:
  #   algorithm: "Astar"     # Используемый алгоритм поиска пути (например, Astar)...
  #   max_iterations: 10000  # Максимальное количество итераций планировщика...
    
  # # Уровень 2: Настройки локального планировщика (Local Planner)
  # local_planner:
  #   # Уровень 3: Ограничения скорости
  #   speed_limits:
  #     max_linear_vel: 0.6    # Максимальная линейная скорость робота (м/с)...
  #     max_angular_vel: 1.5   # Максимальная угловая скорость робота (рад/с)...
      
  #   # Уровень 3: Параметры безопасности
  #   safety_margins:
  #     robot_radius: 0.3      # Радиус робота для избегания столкновений (м)...
  #     emergency_stop_dist: 0.1 # Дистанция для экстренной остановки (м)...