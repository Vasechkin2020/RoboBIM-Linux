# Уровень 1: Главный узел навигации, в котором содержатся все подсистемы
# Глобальная настройка для всех узлов
pb_config:
  # Уровень 2: Общие настройки
  control_mode: 2       # Режим работы управления. Если 0 то по колесам одометрии, 1 управление по model 2 по оценке est

  unit_lidar: 2   # Какой лидар подключен

  unit_modul: 0     
  unit_driver: 1        # Какие модули работает передача в data_node
  unit_print : 1


  pillars:
    # Уровень 3: Параметры
    pillar_0_x: 4.0          # Координата X начала координат карты...
    pillar_0_y: 0.3          # Координата X начала координат карты...
    
    pillar_1_x: 0.0          # Координата X начала координат карты...
    pillar_1_y: 0.5          # Координата X начала координат карты...
    
    pillar_2_x: 0.5          # Координата X начала координат карты...
    pillar_2_y: 4.0          # Координата X начала координат карты...
    
    pillar_3_x: 5.0          # Координата X начала координат карты...
    pillar_3_y: 4.0          # Координата X начала координат карты...
    
  start_pose:
    x: 1.0          # Координата X 
    y: 2.0          # Координата Y 
    th: 0.0         # Угол куда смотрим

  lidar:
    bias: -1.44       # Смещение угла относительно направления движения основы в градусах!!!
  
  modul:
    mode: 5           # Номер алгоритма выполнения при запуске

  uzi_bias: 1.2       # Смещение Ультразвукового датчика
  laser_L_bias: 1.3       # Смещение левого лазерного датчика
  laser_R_bias: 1.4       # Смещение правого лазерного датчика

  laser:
    bias_0: 0.011   # Смещения лазеров.Установить в процессе калибровки
    bias_1: 0.022
    bias_2: 0.033
    bias_3: 0.044


  scan_node:  # --- Все данные для ноды SCAN ---
    pillar_diametr: 0.315                 # Диаметр столба (315 мм)# --- 2. ГЕОМЕТРИЯ СТОЛБОВ (Для финальной калибровки) ---
    
    # Расстояния между поверхностями столбов:
    pillar_0_1: 3.693                  # Расстояние RB-RT (Правая сторона)
    pillar_0_2: 5.787                  # Расстояние RB-LT (Диагональ)
    pillar_0_3: 3.230                  # Расстояние RB-LB (Нижняя сторона)
    pillar_1_2: 3.323                  # Расстояние RT-LT (Верхняя сторона)
    pillar_1_3: 4.643                  # Расстояние RT-LB (Диагональ)
    pillar_2_3: 4.180                  # Расстояние LT-LB (Левая сторона)

    min_cluster_width: 0.20
    max_cluster_width: 0.40
    min_cluster_points: 11 

    jump_dist_threshold: 0.3           # Параметры Детекторов (Этап 2) # Порог разрыва для Метод 1 (0.5 м)
    cluster_dist_threshold: 0.05      # Параметры DBSCAN-кластеризации:  # Порог расстояния (epsilon) для Евклидовой Кластеризации (5 см)

      # Ручные Коэффициенты Доверия Методам (W_method)
    w_method_1_jump: 1.0            # Вес для Метод 1 (Разрыв)
    w_method_2_cluster: 0.9           # Вес для Метод 2 (Кластер)
    w_method_3_minima: 0.8           # Вес для Метод 3 (Минимум)
    
    min_range_filter: 0.2                 # Минимальная дальность (ближе - игнорируется).
    max_range_filter: 15.0                # Максимальная дальность (дальше - игнорируется).
    neighbor_radius_filter: 0.3           # Радиус поиска соседей для фильтрации.# Параметры Statistical Outlier Removal (SOR) или аналогичного фильтра:
    min_neighbors_filter: 3               # Мин. число соседей для сохранения точки.

    intensity_min_threshold: 10.0         # Минимальная интенсивность для включения луча в накопление.# Фильтрация по интенсивности (выполняется в scanCallback)
    edge_angle_threshold_deg: 15.0             # Порог угла в градусах. Угол (0-90) между лучом лидара и сегментом.# Угловой/Краевой фильтр (для удаления фантомов/хвостов в removeEdgeArtifacts)

      # Параметры Взвешивания и Слияния (Этап 3)
    rmse_max_tolerance: 0.01          # Макс. RMSE для нормализации веса
    n_max_points_norm: 100           # Макс. число точек для нормализации веса W_N
    fusion_group_radius: 0.2          # Радиус для объединения кандидатов из разных методов
    min_dbscan_points: 2






















  #   # Уровень 3: Параметры загрузки файла
  # file_settings:
  #   map_file_path: "/home/user/ros_ws/maps/building_A.yaml" # Полный путь к файлу карты...
  #   load_on_start: true                                     # Флаг: загружать ли карту при старте...

  # # Уровень 2: Настройки глобального планировщика (Global Planner)
  # global_planner:
  #   algorithm: "Astar"     # Используемый алгоритм поиска пути (например, Astar)...
  #   max_iterations: 10000  # Максимальное количество итераций планировщика...
    
  # # Уровень 2: Настройки локального планировщика (Local Planner)
  # local_planner:
  #   # Уровень 3: Ограничения скорости
  #   speed_limits:
  #     max_linear_vel: 0.6    # Максимальная линейная скорость робота (м/с)...
  #     max_angular_vel: 1.5   # Максимальная угловая скорость робота (рад/с)...
      
  #   # Уровень 3: Параметры безопасности
  #   safety_margins:
  #     robot_radius: 0.3      # Радиус робота для избегания столкновений (м)...
  #     emergency_stop_dist: 0.1 # Дистанция для экстренной остановки (м)...