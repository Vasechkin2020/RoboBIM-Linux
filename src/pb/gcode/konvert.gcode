; === V 4.0: КОНВЕРТ 2x1, ТОЧНАЯ ГЕОМЕТРИЯ БЕЗ РАЗРЫВОВ ===
; Начальное состояние: ЦВ(0,0), Маркер(0.045, 0).
; Сначала нужно сдать назад, чтобы маркер попал в точку старта BL(0,0).

; === ПОДГОТОВКА К СТАРТУ ===
M5 T1000 ; Маркер поднят
G1 A0.000 F0.05  ; Смотрим вправо
G2 L0.045 F-0.10 ; Откат назад. Теперь Маркер ровно в (0,0)

; === 1. BL -> BR (Низ) ===
M3 T1000 ; Опустить
G2 L2.000 F0.10 ; Рисуем 2.0 м

; --- УГОЛ BR(2,0) ---
M5 T1000
G2 L0.045 F0.10  ; ЦВ в вершину
G4 P200
G1 A90.000 F0.05 ; Поворот на 90
G4 P200
G2 L0.045 F-0.10 ; Откат назад

; === 2. BR -> TR (Правая сторона) ===
M3 T1000
G2 L1.000 F0.10 ; Рисуем 1.0 м

; --- УГОЛ TR(2,1) ---
M5 T1000
G2 L0.045 F0.10 ; ЦВ в вершину
G4 P200
G1 A206.565 F0.05 ; Поворот на диагональ (atan2(-1, -2))
G4 P200
G2 L0.045 F-0.10 ; Откат назад

; === 3. TR -> BL (Диагональ 1) ===
M3 T1000
G2 L2.2361 F0.10 ; Рисуем 2.236 м

; --- УГОЛ BL(0,0) ---
M5 T1000
G2 L0.045 F0.10
G4 P200
G1 A90.000 F0.05 ; Поворот вертикально вверх
G4 P200
G2 L0.045 F-0.10

; === 4. BL -> TL (Левая сторона) ===
M3 T1000
G2 L1.000 F0.10 ; Рисуем 1.0 м

; --- УГОЛ TL(0,1) ---
M5 T1000
G2 L0.045 F0.10
G4 P200
G1 A0.000 F0.05 ; Поворот вправо
G4 P200
G2 L0.045 F-0.10

; === 5. TL -> TR (Верх) ===
M3 T1000
G2 L2.000 F0.10 ; Рисуем 2.0 м

; --- УГОЛ TR(2,1) ---
M5 T1000
G2 L0.045 F0.10
G4 P200
G1 A135.000 F0.05 ; Поворот на клапан
G4 P200
G2 L0.045 F-0.10

; === 6. TR -> Apex (Клапан право) ===
M3 T1000
G2 L1.4142 F0.10 ; Рисуем 1.414 м

; --- УГОЛ Apex(1,2) ---
M5 T1000
G2 L0.045 F0.10
G4 P200
G1 A225.000 F0.05 ; Поворот вниз-влево
G4 P200
G2 L0.045 F-0.10

; === 7. Apex -> TL (Клапан лево) ===
M3 T1000
G2 L1.4142 F0.10 ; Рисуем 1.414 м

; --- УГОЛ TL(0,1) ---
M5 T1000
G2 L0.045 F0.10
G4 P200
G1 A333.435 F0.05 ; Поворот на диагональ 2 (atan2(-1, 2) = -26.565)
G4 P200
G2 L0.045 F-0.10

; === 8. TL -> BR (Диагональ 2) ===
M3 T1000
G2 L2.2361 F0.10 ; Рисуем 2.236 м

; --- ВОЗВРАТ ДОМОЙ ---
M5 T1000
; Сейчас маркер в BR(2,0). Нужно развернуться к BL(0,0).
G2 L0.045 F0.10  ; ЦВ в вершину BR
G4 P200
G1 A180.000 F0.05 ; Разворот влево
G4 P200
G2 L0.045 F-0.10 ; Откат (теперь маркер смотрит на (0,0))

; Едем домой
G2 L2.000 F0.10 ; Едем 2 метра в точку BL

; Финальный разворот в 0
G2 L0.045 F0.10 ; ЦВ в вершину BL
G4 P200
G1 A0.000 F0.05 ; Поворот в исходное
G4 P200
G2 L0.045 F-0.10 ; Откат

; === КОНЕЦ ===